# Модуль нормализации данных

Этот модуль предназначен для очистки, нормализации и фильтрации данных, извлеченных из патентов. Он преобразует разнородные форматы метрик связывания (IC50, Ki и т.д.), их значений и единиц измерения в единый стандартный вид (нМ).

Модуль может работать в двух основных режимах, которые можно настроить с помощью параметров.

## Основная функция `normalize_data`

Главная функция модуля — `normalize_data`. Она принимает список словарей (сырые данные) и возвращает отфильтрованный и очищенный список.

### Параметры:

-   `data` (list): **Обязательный.** Список словарей, где каждый словарь представляет одну строку данных.
-   `allow_log` (bool): По умолчанию `False`. Если `True`, разрешает обработку логарифмических значений (например, pIC50). В этом режиме значения будут конвертированы в линейную шкалу (нМ).
-   `strict_value_parsing` (bool): По умолчанию `True`. Если `True`, парсер значений (`value`) будет принимать только строки, которые можно напрямую преобразовать в число. Если `False`, будет использоваться более сложный парсер, который пытается извлечь числа из строк с диапазонами, знаками "больше/меньше" и т.д.
-   `strict_units` (bool): По умолчанию `True`. Если `True`, в обработку принимаются только данные с единицами измерения `nM`. Данные с другими единицами (uM, mM, pM) будут отфильтрованы. Если `False`, будет производиться конвертация из других единиц в `nM`.
-   `value_range` (tuple): По умолчанию `(0.01, 1000)`. Кортеж `(min, max)`, определяющий допустимый диапазон для конечного значения в `nM`. Записи, не попадающие в этот диапазон, будут отфильтрованы.

## Режимы использования

### 1. Строгий режим

Этот режим используется для получения максимально "чистых" данных. Это настройки по умолчанию.

```python
# В главном скрипте пайплайна
from data_normalization.normalize_data import normalize_data
from some_module import get_raw_data

# 1. Получить сырые данные
raw_data = get_raw_data() 

# 2. Вызвать функцию нормализации с настройками по умолчанию
cleaned_data = normalize_data(raw_data)

# 3. Передать очищенные данные на следующий этап
process_further(cleaned_data)
```

### 2. Режим "Поиск новых данных" (Discovery)

Этот режим использует более "мягкие" фильтры для извлечения максимального количества информации, включая данные из "грязных" или нестандартных форматов.

```python
# В главном скрипте пайплайна
from data_normalization.normalize_data import normalize_data
from some_module import get_raw_data

# 1. Получить сырые данные
raw_data = get_raw_data() 

# 2. Вызвать функцию нормализации с настройками для "поиска"
discovery_data = normalize_data(
    data=raw_data,
    allow_log=True,
    strict_value_parsing=False,
    strict_units=False,
    value_range=(0.001, 1000000) # Используем более широкий диапазон
)

# 3. Передать данные на следующий этап
process_for_discovery(discovery_data)
```
